!function(e){var t,n=!1;function r(){var e="test";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}}function i(e,t){var n=e.getItem(t);return n&&JSON.parse(n)}function a(a){if(!n){n=!0;var o="wpcf7msm_pipe_flow_id",f=cf7msm_posted_data,s=e("input[name='_cf7msm_multistep_tag']"),c=s.length>0;if(c||(c=(s=e("input[name='cf7msm-step']")).length>0),c){var l=s.closest("form"),p=l.find('input[name="_wpcf7"]').val();r()?null!=(t=i(sessionStorage,"cf7msm"))&&e.each(t,function(e,t){if("cf7msm_prev_urls"==e){var n=l.find(".wpcf7-back, .wpcf7-previous"),r=window.location.href,i=r.replace(/\/$/,""),a=!t.hasOwnProperty(r)||""==t[r];a&&(a=!t.hasOwnProperty(i)||""==t[i]),a&&(r=r.split("?")[0],i=r.replace(/\/$/,""),(a=!t.hasOwnProperty(r)||""==t[r])&&(a=!t.hasOwnProperty(i)||""==t[i])),a?n.hide():n.click(function(e){t.hasOwnProperty(r)&&""!=t[r]?window.location.href=t[r]:t.hasOwnProperty(i)&&""!=t[i]?window.location.href=t[i]:window.history.go(-1),e.preventDefault()})}}):(e("input[name='cf7msm-no-ss']").val(1),e(".wpcf7-previous").hide());var u=wpcf7.submit;wpcf7.submit=function(t,n){!function(t){(function(t){var n=t;n instanceof jQuery||(n=e(t));var r=d(n);if(0==r.length)return;r.length>1&&(r=r.last());e("<input />",{type:"hidden",name:"cf7msm_options",value:r.val()}).appendTo(n)})(t),h(t),function(t){var n=t;n instanceof jQuery||(n=e(t));var r=e(".has-free-text",n);r.each(function(){var t=e(this),n=e("input:checkbox",t);if(0==n.length&&(n=e("input:radio",t)),0==n.length)return!1;var r=n.attr("name");r.indexOf("[]")===r.length-2&&(r=r.substring(0,r.length-2));var i="_cf7msm_free_text_reflen_"+r,a=e('input[name="'+i+'"]',t);n.is(":checked")?(0==a.length&&(a=e('<input type="hidden" name="'+i+'">'),t.append(a)),a.val(n.val().length)):a.length>0&&a.remove()})}(t)}(t),u(t,n)},a&&v(),window.addEventListener("load",function(){v()}),document.addEventListener("wpcf7mailsent",function(n){var a,o,f,s=e("#"+n.detail.unitTag+" form");if(r()){var c=0,l=0,u=[],m={};(t=i(sessionStorage,"cf7msm"))||(t={});var d=!1,h=!1,v=!0,g=!1,_=null,w=!1,y=e(".has-free-text",s),O={};if(e.each(n.detail.inputs,function(t){var r=n.detail.inputs[t].name,i=n.detail.inputs[t].value,a=e('input[name="'+r+'"]',y);if(a.length>0&&a.is(":checked")){var o=r;r.indexOf("[]")===r.length-2&&(o=r.substring(0,r.length-2));var f=i.length,s=e('input[name="_wpcf7_free_text_'+o+'"]',y).val(),x="_cf7msm_free_text_reflen_"+o;r.indexOf("[]")===r.length-2?O[r]={value:i,free_text:s,ref_len:f,ref_name:x}:(i+=" "+s,m[x]=f)}if(r.indexOf("[]")===r.length-2?(-1===e.inArray(r,u)&&(m[r]=[]),m[r].push(i)):m[r]=i,"cf7msm-step"===r){if(-1!==i.indexOf("-")){d=!0,h=!1;var b=i.split("-");c=parseInt(b[0]),l=parseInt(b[1]),void 0!==cf7msm_redirect_urls[p]&&(_=cf7msm_redirect_urls[p]),c<l?v=!1:c===l&&(g=!0)}}else if("cf7msm_options"===r){d=!0,h=!0,v=!1;var k=JSON.parse(i);k.hasOwnProperty("next_url")&&(_=k.next_url),k.hasOwnProperty("last_step")&&(w=!0,_&&""!==_||(g=!0,v=!0))}else u.push(r)}),e.each(O,function(e,t){if(m.hasOwnProperty(e)&&m[e].length>0){var n=m[e].length-1;m[e][n]===t.value&&(m[e][n]+=" "+t.free_text,m[t.ref_name]=t.ref_len)}}),!d)return;if(!v){var x=e("#"+n.detail.unitTag).find("div.wpcf7-mail-sent-ok");0==x.length&&(x=e("#"+n.detail.unitTag).find(".wpcf7-response-output")),x.remove()}if(g&&(s.find("*").not("div.wpcf7-response-output").hide(),s.find("div.wpcf7-response-output").parentsUntil("form").show()),h?w&&(t={}):0!=c&&c===l&&(t={}),_&&""!=_){var b=document.createElement("a");b.href=_;var k=b.hostname+(b.port?":"+b.port:""),S={};t&&t.cf7msm_prev_urls&&(S=t.cf7msm_prev_urls);var P=window.location.protocol+"//"+window.location.host;0===_.indexOf(P)||""!=k&&k!=window.location.host||(0!==_.indexOf("/")&&(P+="/"),_=P+_),S[_]=window.location.href;var j=_.split("?")[0];_!=j&&(S[j]=window.location.href),t.cf7msm_prev_urls=S}a=sessionStorage,o="cf7msm",f=t,a.setItem(o,JSON.stringify(f)),_&&""!=_&&(window.location.href=_)}},!1)}}function m(){if(window.crypto&&window.crypto.getRandomValues){var e=new Uint8Array(16);window.crypto.getRandomValues(e);for(var t="",n=0;n<e.length;n++){var r=e[n].toString(16);t+=r.length<2?"0"+r:r}return t}return String(Date.now())+Math.random().toString(36).substring(2,14)}function d(e){return e.find("input[name='_cf7msm_multistep_tag']")}function h(n){var r=n;if(r instanceof jQuery||(r=e(n)),0!==r.length&&function(e){return e.find("input[name='_cf7msm_multistep_tag']").length>0||e.find("input[name='cf7msm-step']").length>0}(r)){var i=function(e){var t=d(e);if(t.length>0)try{var n=JSON.parse(t.last().val());return!(!n||!n.first_step)}catch(i){return!1}var r=e.find("input[name='cf7msm-step']");return r.length>0&&/^1-\d+$/.test(r.last().val())}(r)?m():function(e){var n=e.find('input[name="'+o+'"]');return n.length>0&&n.last().val()?n.last().val():f&&"object"==typeof f&&f.hasOwnProperty(o)&&f[o]?f[o]:t&&"object"==typeof t&&t.hasOwnProperty(o)&&t[o]?t[o]:m()}(r);r.find('input[name="'+o+'"]').remove(),e("<input />",{type:"hidden",name:o,value:i}).appendTo(r),f&&"object"==typeof f&&(f[o]=i),t&&"object"==typeof t&&(t[o]=i)}}function v(){f&&(e.each(f,function(t,n){if(t.indexOf("[]")===t.length-2&&(t=t.substring(0,t.length-2)),0!=t.indexOf("_")&&"cf7msm-step"!=t&&"cf7msm_options"!=t){var r=l.find('*[name="'+t+'"]:not([data-cf7msm-previous])'),i=l.find('input[name="'+t+'[]"]:not([data-cf7msm-previous])'),a=l.find('select[name="'+t+'[]"]:not([data-cf7msm-previous])');if(r.length>0)if("radio"==r.prop("type")||"checkbox"==r.prop("type")){if(null!==(s=g(f,t,n)))(c=r.filter('[value="'+s.new_val+'"]')).length>0&&(e('input[name="_wpcf7_free_text_'+t+'"]',l).val(s.free_val),n=s.new_val);r.filter(function(){return e(this).val()==n}).prop("checked",!1).trigger("click",[{cf7msm:!0}])}else if(r.is("select")){var o=n;o&&o.constructor===Array&&(o=o.length>0?o[0]:""),r.find("option").filter(function(){return this.value==o}).prop("selected",!0)}else r.val(n);else if(i.length>0&&n.constructor===Array){""!=n&&n.length>0&&e.each(n,function(t,n){i.filter(function(){return e(this).val()==n}).prop("checked",!1).trigger("click",[{cf7msm:!0}])});var s,c,p=n[n.length-1];if(null!==(s=g(f,t,p)))if((c=i.filter('[value="'+s.new_val+'"]')).length>0)c.prop("checked",!1).trigger("click",[{cf7msm:!0}]),e('input[name="_wpcf7_free_text_'+t+'"]').val(s.free_val)}else if(a.length>0&&n.constructor===Array){var u=n;u&&u.constructor!==Array&&(u=[u]),""!=u&&u.length>0&&e.each(u,function(e,t){a.find("option").filter(function(){return this.value==t}).prop("selected",!0)})}}}),l.find('input[name="_wpcf7cf_options"]').trigger("change"))}function g(e,t,n){var r=n;n.constructor===Array&&(r=n[n.length-1]);var i=null,a="_cf7msm_free_text_reflen_"+t;if(a in e){var o=parseInt(e[a]);o<=r.length&&(i={new_val:r.substring(0,o),free_val:r.substring(o+1)})}return i}}window.addEventListener("DOMContentLoaded",e=>{a()}),window.addEventListener("pagehide",e=>{n=!1}),window.addEventListener("pageshow",e=>{a(e.persisted)})}(jQuery);
