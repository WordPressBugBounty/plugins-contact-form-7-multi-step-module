function e(){var e="test";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}}!function(t){var n,i=!1;function r(r){if(!i){i=!0;var a=cf7msm_posted_data,s=t("input[name='_cf7msm_multistep_tag']"),o=s.length>0;if(o||(o=(s=t("input[name='cf7msm-step']")).length>0),o){var f=s.closest("form"),c=f.find('input[name="_wpcf7"]').val();e()?null!=(n=sessionStorage.getObject("cf7msm"))&&t.each(n,function(e,t){if("cf7msm_prev_urls"==e){var n=f.find(".wpcf7-back, .wpcf7-previous"),i=window.location.href,r=i.replace(/\/$/,""),a=!t.hasOwnProperty(i)||""==t[i];a&&(a=!t.hasOwnProperty(r)||""==t[r]),a&&(i=i.split("?")[0],r=i.replace(/\/$/,""),(a=!t.hasOwnProperty(i)||""==t[i])&&(a=!t.hasOwnProperty(r)||""==t[r])),a?n.hide():n.click(function(e){t.hasOwnProperty(i)&&""!=t[i]?window.location.href=t[i]:t.hasOwnProperty(r)&&""!=t[r]?window.location.href=t[r]:window.history.go(-1),e.preventDefault()})}}):(t("input[name='cf7msm-no-ss']").val(1),t(".wpcf7-previous").hide());var l=wpcf7.submit;wpcf7.submit=function(e,n){!function(e){(function(e){var n=e;n instanceof jQuery||(n=t(e));var i=n.find("input[name='_cf7msm_multistep_tag']");if(0==i.length)return;i.length>1&&(i=i.last());t("<input />",{type:"hidden",name:"cf7msm_options",value:i.val()}).appendTo(n)})(e),function(e){var n=e;n instanceof jQuery||(n=t(e));var i=t(".has-free-text",n);i.each(function(){var e=t(this),n=t("input:checkbox",e);if(0==n.length&&(n=t("input:radio",e)),0==n.length)return!1;var i=n.attr("name");i.indexOf("[]")===i.length-2&&(i=i.substring(0,i.length-2));var r="_cf7msm_free_text_reflen_"+i,a=t('input[name="'+r+'"]',e);n.is(":checked")?(0==a.length&&(a=t('<input type="hidden" name="'+r+'">'),e.append(a)),a.val(n.val().length)):a.length>0&&a.remove()})}(e)}(e),l(e,n)},r&&p(),window.addEventListener("load",function(){p()}),document.addEventListener("wpcf7mailsent",function(i){var r=t("#"+i.detail.unitTag+" form");if(e()){var a=0,s=0,o=[],f={};(n=sessionStorage.getObject("cf7msm"))||(n={});var l=!1,p=!1,u=!0,m=!1,d=null,h=!1,v=t(".has-free-text",r);if(t.each(i.detail.inputs,function(e){var n=i.detail.inputs[e].name,r=i.detail.inputs[e].value,_=t('input[name="'+n+'"]',v);if(_.length>0&&_.is(":checked")){var g=n;n.indexOf("[]")===n.length-2&&(g=n.substring(0,n.length-2));var w=r.length;r+=" "+t('input[name="_wpcf7_free_text_'+g+'"]',v).val(),f["_cf7msm_free_text_reflen_"+g]=w}if(n.indexOf("[]")===n.length-2?(-1===t.inArray(n,o)&&(f[n]=[]),f[n].push(r)):f[n]=r,"cf7msm-step"===n){if(-1!==r.indexOf("-")){l=!0,p=!1;var O=r.split("-");a=parseInt(O[0]),s=parseInt(O[1]),void 0!==cf7msm_redirect_urls[c]&&(d=cf7msm_redirect_urls[c]),a<s?u=!1:a===s&&(m=!0)}}else if("cf7msm_options"===n){l=!0,p=!0,u=!1;var y=JSON.parse(r);y.hasOwnProperty("next_url")&&(d=y.next_url),y.hasOwnProperty("last_step")&&(h=!0,d&&""!==d||(m=!0,u=!0))}else o.push(n)}),!l)return;if(!u){var _=t("#"+i.detail.unitTag).find("div.wpcf7-mail-sent-ok");0==_.length&&(_=t("#"+i.detail.unitTag).find(".wpcf7-response-output")),_.remove()}if(m&&(r.find("*").not("div.wpcf7-response-output").hide(),r.find("div.wpcf7-response-output").parentsUntil("form").show()),p?h&&(n={}):0!=a&&a===s&&(n={}),d&&""!=d){var g=document.createElement("a");g.href=d;var w=g.hostname+(g.port?":"+g.port:""),O={};n&&n.cf7msm_prev_urls&&(O=n.cf7msm_prev_urls);var y=window.location.protocol+"//"+window.location.host;0===d.indexOf(y)||""!=w&&w!=window.location.host||(0!==d.indexOf("/")&&(y+="/"),d=y+d),O[d]=window.location.href;var x=d.split("?")[0];d!=x&&(O[x]=window.location.href),n.cf7msm_prev_urls=O}sessionStorage.setObject("cf7msm",n),d&&""!=d&&(window.location.href=d)}},!1)}}function p(){a&&(t.each(a,function(e,n){if(e.indexOf("[]")===e.length-2&&(e=e.substring(0,e.length-2)),0!=e.indexOf("_")&&"cf7msm-step"!=e&&"cf7msm_options"!=e){var i=f.find('*[name="'+e+'"]:not([data-cf7msm-previous])'),r=f.find('input[name="'+e+'[]"]:not([data-cf7msm-previous])'),s=f.find('select[name="'+e+'[]"]:not([data-cf7msm-previous])');if(i.length>0)if("radio"==i.prop("type")||"checkbox"==i.prop("type")){if(null!==(o=u(a,e,n)))(c=i.filter('[value="'+o.new_val+'"]')).length>0&&(t('input[name="_wpcf7_free_text_'+e+'"]',f).val(o.free_val),n=o.new_val);i.filter(function(){return t(this).val()==n}).prop("checked",!1).trigger("click",[{cf7msm:!0}])}else i.is("select")?i.find("option").filter(function(){return this.value==n}).prop("selected",!0):i.val(n);else if(r.length>0&&n.constructor===Array){""!=n&&n.length>0&&t.each(n,function(e,n){r.filter(function(){return t(this).val()==n}).prop("checked",!1).trigger("click",[{cf7msm:!0}])});var o,c,l=n[n.length-1];if(null!==(o=u(a,e,l)))if((c=r.filter('[value="'+o.new_val+'"]')).length>0)c.prop("checked",!1).trigger("click",[{cf7msm:!0}]),t('input[name="_wpcf7_free_text_'+e+'"]').val(o.free_val)}else s.length>0&&n.constructor===Array&&""!=n&&n.length>0&&t.each(n,function(e,t){s.find("option").filter(function(){return this.value==t}).prop("selected",!0)})}}),f.find('input[name="_wpcf7cf_options"]').trigger("change"))}function u(e,t,n){var i=n;n.constructor===Array&&(i=n[n.length-1]);var r=null,a="_cf7msm_free_text_reflen_"+t;if(a in e){var s=parseInt(e[a]);s<=i.length&&(r={new_val:i.substring(0,s),free_val:i.substring(s+1)})}return r}}window.addEventListener("DOMContentLoaded",e=>{r()}),window.addEventListener("pagehide",e=>{i=!1}),window.addEventListener("pageshow",e=>{r(e.persisted)})}(jQuery),Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)};
